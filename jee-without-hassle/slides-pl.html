<!DOCTYPE html><html lang="en" class="aspect-4-3"><head><meta charset="UTF-8"><meta name="generator" content="Asciidoctor 0.1.4, dzslides backend"><title>JEE&#8217;ish development without hassle</title><meta name="author" content="Kuba Marchwicki"><link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic&amp;subset=latin,latin-ext&amp;family=Cedarville+Cursive"><link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/font-awesome/3.2.1/css/font-awesome.min.css"><link rel="stylesheet" href="./dzslides/themes/highlight/tomorrow.css"><link rel="stylesheet" href="./dzslides/themes/style/stormy-jm.css"><style>section:not(.topic) > h2 { display: none;}</style><link rel="stylesheet" href="./dzslides/core/dzslides.css"><link rel="stylesheet" href="./dzslides/themes/transition/fade.css"></head><body><section class="title"><h1>JEE&#8217;ish development without hassle</h1><footer><span class="author">Kuba Marchwicki</span><span class="divider">&nbsp;&middot;&nbsp;</span><span class="author">@kubem</span></footer></section><section><figure><img class="frame" src="images/karty-java.png" alt="karty java"><figcaption>Archetyp programisty Java</figcaption></figure>
<details><details open=""><ul><li>I ja się temu nie dziwię.<ul><li>Ostatnio spotkałem się z firmą której wielkim sukcesem było że wchodzą w annotacje.</li><li>SRSLY! Mamy 2014. Java5 EOL było w październiku 2009</li></ul></li><li>Także smutne jest życie developera</li></ul></details></details></section>
<section><figure><img class="frame-right" src="images/karty-ios.png" alt="karty ios"><figcaption>Archetyp programisty Java</figcaption></figure>
<details><details open=""><ul><li>I pewnie wielu z nas marzy się taka hipsterska praca<ul><li>Poprogramować w Haskellu, w Switfcie</li><li>Albo chociaż w Javie8 zrobić kilka domknięć</li></ul></li><li>A oni mi tutaj ciągle EJB3.0 (jak mamy szczęście).</li></ul></details></details></section>
<section><figure><img class="frame" src="images/git_log.png" alt="git log"><figcaption>Typowy projekt korporacyjny</figcaption></figure>
<details><details open=""><ul><li>Zwróćie uwagę na daty przy commitach</li><li>Taka jest niestety nasza smutna projektowa rzeczywistość</li><li>To jest projekt który istniał nim przyszliście i będzie istniał długo po waszym odejściu</li><li>Więc trafiacie do takiego projektu</li></ul></details></details></section>
<section class="topic"><h2>Projekt ma swoje założenia</h2><dl class="incremental scatter"><dt>JEE == EJB</dt><dd>bo tak</dd><dt>Spring Framework</dt><dd>bo jest lightweight</dd><dt>JPA</dt><dd>object map everything</dd></dl>
<details><details open=""><ul><li>Oczywiście że ma</li><li>Używamy JEE już od tak dawna że nikt nie wie dlaczego<ul><li>Eksperyment z małpami i bananami</li></ul></li><li>Spring Framework był lightweight w 2006<ul><li>JEE6 pojawiła się jako alternatywa dla springa, gdzie było już za dużo</li><li>Bo 80% aplikacji to było ORM + DI + View Components (JPA + EJB + JSF, JPA + Spring + Spring MVC)</li></ul></li><li>JPA - zmapujmy wszystko na obiekty</li><li>Ja nie mówię że to sa złe założenia - są doskonałe, w pewnym kontekście<ul><li>Zwalniają nas z myślenia o kontekście</li></ul></li></ul></details></details></section>
<section class="topic"><h2>Projekt ma swoje niespodzianki</h2><p class="statement"><span class="detail">IDE</span><br>
IDE<br>
<strong>IDE</strong> &#8594; <span class="detail">alt + tab</span></p>
<details><details open=""><ul><li>Dziwne projekty na uboczu<ul><li>Mobliny, responsywny frontend dla webserviców</li><li>Tymczasowy e-sklep dla repozytorium zasobów (np. zdjęć)</li><li>Automatyzacja pewnych procesów</li><li>Zwiększenie efektywności czynnika białkowego (tj. ludzkiego)</li></ul></li><li>W każdym projekcie to miałem</li><li>Będę się posługiwał przykładem: TodoMVC</li><li>Co z taką niespodzianką zrobić?</li></ul></details></details></section>
<section class="topic"><h2>Co to za projekt?</h2><ul><li>Baza danych <span class="detail">MySQL by nie wymyślać</span></li><li>Dostęp do danych <span class="detail"><strong>będzie grzebanie</strong></span></li><li>Warstaw logiki <span class="detail">ubogi CRUD</span></li><li>Jakiś kontroler <span class="detail"><strong>na różne sposoby</strong></span></li><li>Widoki <span class="detail">backbone.js</span></li></ul>
<details><details open=""><ul><li>Nie ma tutaj filozofii - jest to co w każdym projekcie</li><li>Ale pozwala uchwycić kilka rzeczy</li></ul></details></details></section>
<section class="topic"><h2>No to co z nim?</h2><figure><img class="frame" src="images/einstein.jpg" alt="einstein"><figcaption>To co zawsze!</figcaption></figure>
<details><details open=""><ul><li>używamy dokładnie tych samych narzędzi których użwalismy dotychczas</li><li>jeżeli mieliśmy aplikację na stosie JEE, to dowolny fragment webu robimy w JSF</li><li>jak ktoś chciał frontendu do naszych webservice&#8217;ow JAX-WS<ul><li>shang bang - jest JSF</li></ul></li><li>I utyskujemy na wybory technologiczne tak jak zawsze utyskiwaliśmy</li></ul></details></details></section>
<section><div class="listingblock"><div class="title"><code>TodoMVCResource.java</code></div><pre class="highlight"><code class="java">@Path("/")
@Produces(MediaType.APPLICATION_JSON)
public class TodoMVCResource {

    private final Store store;

    @GET
    public List&lt;Todo&gt; getAll() {
        return store.getAll();
    }

    //..
    //methods omitted for brevity
}</code></pre></div>
<div class="listingblock"><div class="title"><code>runner.sh</code></div><pre class="highlight"><code class="bash">{ ~ } » java -jar tomee-embedded.jar --path my-application.war</code></pre></div>
<details><details open=""><ul><li>Tak by to mogło wyglądać za pomocą JEE</li><li>+ pewna mała zależność w pom.xml<ul><li>sztuk dwie</li></ul></li></ul></details></details></section>
<section><div class="listingblock"><div class="title"><code>TodoMVCController.java</code></div><pre class="highlight"><code class="java">@RestController
public class TodoMVCController {

    private final Store store;

    @Autowired
    public TodoMVCController(Store store) {
        this.store = store;
    }

    @RequestMapping(value = "/todos",
            method = RequestMethod.GET,
            produces = MediaType.APPLICATION_JSON_VALUE)
    public List&lt;Todo&gt; getAllTodos() {
        return store.getAll();
    }

    //..
}</code></pre></div>
<details><details open=""><ul><li>A taki byłby efekt w Springu</li><li>Niby wszystko jest w porządku. Jest single jar ;)</li><li>Prawie jak mikroserwis</li><li>Możliwe że nawet nie dotykaliśmy oryginalnej aplikacji<ul><li>I to jest akuratnie ważne. Przy pracy z legacy utrzymanie produkcji jeszcze szczególnie istotne</li><li>Co najwyżej na poziomie bazy danych (nie najgorsze sprzęgnięcie)</li></ul></li><li>Zerknijmy jak to wygląda od storny <strong>IDE</strong></li><li>IDE IDE IDE IDE (boot configuration, spring  data - robi się samo)</li></ul></details></details></section>
<section><p class="statement middle">Czyli w <strong>porządku?</strong></p>
<details><details open=""><ul><li>Spring odwalił za mnie robotę</li><li>Jestem szczęśliwym developerem<ul><li>Mogę iść zagrać w piłkarzyki</li></ul></li><li>Ja nie neguję developer&#8217;s joy ani używania Spring ani JEE<ul><li>Ale te frameworki trochę starają się nas zwolnić z myślenia</li></ul></li></ul></details></details></section>
<section><ul class="incremental"><li>Servlet <span class="detail">od niego wszystko się zaczyna</span></li><li>Response Mapping <span class="detail">Jackson / Jettison</span></li><li>Dispatcher <span class="detail">Spring</span> / Container <span class="detail">JEE</span></li><li>Dependency Container <span class="detail">Spring / CDI</span></li><li>TransactionManager</li><li>ORM (EntityManager)</li><li>ResultSet <span class="detail">JDBC</span></li><li>DataSource</li><li>SQL</li></ul>
<details><details open=""><ul><li>Zasnanówmy się co Spring Boot / Data albo TomEE zrobiło za nas? <strong>Co dzieje się pod spodem</strong></li><li>Przejdźmy przez warstwy które się pojawiły</li><li>A czy można spróbować "bliżej metalu"?<ul><li>Gdy leci wyjątek to wiemy o co chodzi a nie szukamy to stackoverflow</li><li>Blisko http i SQL (bo właśnie taką ablikację robimy)</li></ul></li></ul></details></details></section>
<section><ul><li><strong>Servlet</strong> <span class="detail">od niego wszystko się zaczyna</span></li><li><strong>Response Mapping</strong> <span class="detail">Jackson / Jettison</span></li><li>Dispatcher <span class="detail">Spring</span> / Container <span class="detail">JEE</span></li><li>Dependency Container <span class="detail">Spring / CDI</span></li><li>TransactionManager</li><li>ORM (EntityManager)</li><li><strong>ResultSet</strong> <span class="detail">JDBC</span></li><li><strong>DataSource</strong></li><li><strong>SQL</strong></li></ul>
<details><details open=""><ul><li>A czego tak właściwie potrzebujemy w naszej prostej aplikacji?</li><li>50% do kosza. To się nazywa overengineering</li><li>Zatem można łatwiej. Można!</li></ul></details></details></section>
<section class="topic"><h2>Można łatwiej?</h2><ul class="middle incremental"><li>Jetty + Sql2o</li><li>Jetty + RESTeasy + MyBatis</li><li>Spark + jOOQ</li><li>Webbit + jDBI</li><li>Dropwizard <span class="detail">Jetty + Jersey + jDBI</span></li></ul>
<details><details open=""><ul><li>Moim celem nie będzie dokładnie przedstawienie frameworków<ul><li>Liznę temat. Nie ma czasu na szczegóły</li><li>Sam nie znam wszystkich szczegółów</li><li>Jeżeli któregokolwiek z tych używaliście w projekcie - pewnie wiecie więcej ode mnie</li><li>Ale nie o to tutaj chodzi</li></ul></li><li>Pokażę pewną filozowię<ul><li>Libraries over frameworks.</li><li>Zarówno w kwestii aplikacji webowych jak i bazodanowych</li></ul></li></ul></details></details></section>
<section><ul class="middle"><li><strong>Jetty + Sql2o</strong></li><li>Jetty + RESTeasy + MyBatis</li><li>Spark + jOOQ</li><li>Webbit + jDBI</li><li>Dropwizard <span class="detail">Jetty + Jersey + jDBI</span></li></ul></section>
<section><dl><dt>Jetty</dt><dd>Small footprint web server and javax.servlet container</dd><dt>Sql2o</dt><dd>Sql2o is a small java framework that makes it easy to execute sql statements on your JDBC compliant database from java.</dd></dl>
<details><details open=""><ul><li>O ile do Jetty to nie trzeba przekonywać, to Sql2o wygląda na dziwadło</li><li>IDE IDE IDE IDE</li><li>A zastanawialiście się kiedyś nad wydajnością poszczególnych elementów?</li></ul></details></details></section>
<section><table class="tableblock frame-all grid-all" style="width: 100%"><colgroup><col style="width: 50%"><col style="width: 50%"></colgroup><thead><tr><th class="tableblock halign-left valign-top">Method</th><th class="tableblock halign-left valign-top">Duration</th></tr></thead><tbody><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Hand coded <code>ResultSet</code></p></td><td class="tableblock halign-left valign-top"><p class="tableblock">60ms</p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Sql2o</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">75ms <span class="detail">(25% slower)</span></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Apache DbUtils</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">98ms <span class="detail">(63% slower)</span></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">JDBI</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">197ms <span class="detail">(228% slower)</span></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">MyBatis</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">293ms <span class="detail">(388% slower)</span></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">jOOQ</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">447ms <span class="detail">(645% slower)</span></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Hibernate</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">494ms <span class="detail">(723% slower)</span></p></td></tr><tr><td class="tableblock halign-left valign-top"><p class="tableblock">Spring JdbcTemplate</p></td><td class="tableblock halign-left valign-top"><p class="tableblock">636ms <span class="detail">(960% slower)</span></p></td></tr></tbody></table>
<div class="listingblock"><pre>sql2o/PojoPerformanceTest.java --&gt; http://goo.gl/cwNkRN</pre></div>
<details><details open=""><ul><li>1000 SELECT statements against a DB and map the data returned to a POJO</li><li>Można z tym dyskutować - i bardzo dobrze.</li><li>Poza reklamowanym przyrostem prędkości mamy jeszcze coś<ul><li>przede wszystkim, jak już leci wyjątek to dokładnie wiemy gdzie :)</li></ul></li></ul></details></details></section>
<section><ul class="middle"><li>Jetty + Sql2o</li><li><strong>Jetty + RESTeasy + MyBatis</strong></li><li>Spark + jOOQ</li><li>Webbit + jDBI</li><li>Dropwizard <span class="detail">Jetty + Jersey + jDBI</span></li></ul></section>
<section><dl><dt>RESTeasy</dt><dd>RESTEasy is a JBoss project that provides various frameworks to help you build RESTful Web Services and RESTful Java applications</dd><dt>MyBatis</dt><dd>MyBatis is a first class persistence framework with support for custom SQL, stored procedures and advanced mappings</dd></dl>
<details><details open=""><ul><li>RESTeasy jest dość znane, natomiast myBatis może być pewnym hipsterstwem</li><li>O ile sql2o trzymało zapytania SQL bezpośrendio w kodzie, co może być nie-ok<ul><li>myBatis "extrenalizuje je" w jednym miejscu (XML lub annotacje)</li></ul></li><li>Znowu, za każdym razem świadomie podejmujemy decyzję, na którą abstrakcję się decydujemy</li></ul></details></details></section>
<section><ul class="middle"><li>Jetty + Sql2o</li><li>Jetty + RESTeasy + MyBatis</li><li><strong>Spark + jOOQ</strong></li><li>Webbit + jDBI</li><li>Dropwizard <span class="detail">Jetty + Jersey + jDBI</span></li></ul></section>
<section><dl><dt>Spark</dt><dd>A Sinatra inspired micro web framework for quickly creating web applications in Java with minimal effort</dd><dt>jOOQ</dt><dd>jOOQ generates Java code from your database and lets you build typesafe SQL queries through its fluent API</dd></dl></section>
<section><ul class="middle"><li>Jetty + Sql2o</li><li>Jetty + RESTeasy + MyBatis</li><li>Spark + jOOQ</li><li><strong>Webbit + jDBI</strong></li><li>Dropwizard <span class="detail">Jetty + Jersey + jDBI</span></li></ul></section>
<section><dl><dt>Webbit</dt><dd>An event-based, single threaded WebSocket and HTTP server in Java</dd><dt>jDBI</dt><dd>jDBI is a SQL convenience library for Java. It attempts to expose relational database access in idiommatic Java, using collections, beans, and so on, while maintaining the same level of detail as JDBC. It exposes two different style APIs, a fluent style and a sql object style.</dd></dl>
<details><details open=""><ul><li>webbit - bazuje na netty<ul><li>podobieństwo do node.js zamierzone</li><li>Jak większość takich ultraszybkich rzeczy powstało na potrzeby biur maklerskich (trading company - DRW trading tego od Dana Northa i Joe Walesa)</li><li>oczywiście tutaj aż się prosi wspomnieć o vert.x - ale o nim nie będę mówił</li></ul></li></ul></details></details></section>
<section><ul class="middle"><li>Jetty + Sql2o</li><li>Jetty + RESTeasy + MyBatis</li><li>Spark + jOOQ</li><li>Webbit + jDBI</li><li><strong>Dropwizard</strong> <span class="detail">Jetty + Jersey + jDBI</span></li></ul></section>
<section><dl><dt>Dropwizard</dt><dd>Dropwizard is a Java framework for developing ops-friendly, high-performance, RESTful web services.<br>
Dropwizard pulls together stable, mature libraries from the Java ecosystem into a simple, light-weight package that lets you focus on getting things done.</dd></dl>
<details><details open=""><ul><li>Taki marketing jargon</li><li>Dropwizard zaczął jako mega prosty&#8230; nie-framework.</li><li>Powstał dla twittera, tak jak webbit powstał dla DRW Trading<ul><li>Pomiędzy 0.6 a 0.7 dodano sporo, aby dostosować sie do wszystkich</li><li>Nie tylko coda hale, oryginalnego autora</li></ul></li><li>My skupimy się Jetty + Jersey + jDBI<ul><li>To co daje dropwizard to jest fajny plumbing i API do poszczególnych obiektów</li><li>Umozliwia automatyczne podpięcie się pod cykl życia kontenera<ul><li>Np. Menaged Resources (Managed Objects for database access)</li></ul></li><li>Nie będę skupiał na szczegółach - wystarczająco osób opowiadało tutaj o Dropwizardzie</li></ul></li></ul></details></details></section>
<section class="topic"><h2>Słowem podsumowania</h2><p class="statement"><strong>Po co?</strong></p>
<details><details open=""><ul><li>Marry Poppendieck mówi o <em>Sharpening the Saw</em><ul><li>Ćwiczymy w momentach gdy jest to bezpieczne</li></ul></li><li>Innowacja ala John Cleese<ul><li>Space (separeted), Time (for certain amout of time, timeboxed),
Time (to get creative, not operational), confidence (small chunk, we can get to Spring back), Fun (why, because we can ad we are nerds)</li></ul></li><li>Staramy się zrozumieć istotę rzeczy a nie ślizgać się po wierzchu</li><li>Zobaczcie, np. w ogóle nie używałem kontenera zależności.. po co? :)<ul><li>To tak jak z różnicą pomiedzy koderem a inżynierem. Po kursie programowania i po informatyce.</li><li>Dwie różne bajki</li></ul></li></ul></details></details></section>
<section class="topic ending"><h2 class="name">Pytania?</h2><p class="footer"><em class="icon-twitter">&#8203;</em> @kubem</p></section>
<section class="topic"><h2>Przydatne linki i inne takie</h2><div class="listingblock"><pre>http://speakerdeck.com/kubamarchwicki/jee-without-hassle-pl

Follow me on twitter
  @kubem

Projekt z przykładami
  https://github.com/kubamarchwicki/micro-java
  Frontend jest stąd: https://github.com/tastejs/todomvc
  Pewna inspiracja: https://github.com/kouphax/todomvc-server

Ta prezentacja została zrobiona przy pomocy AsciiDoctora
  http://asciidoctor.org/
  https://github.com/kubamarchwicki/presentations/

Web
  http://www.eclipse.org/jetty/
  http://resteasy.jboss.org/
  http://www.sparkjava.com/
  http://webbitserver.org/
  http://dropwizard.io/

Baza danych
  http://sql2o.org/
  http://mybatis.github.io/mybatis-3/
  http://jooq.org/
  http://jdbi.org/</pre></div></section><script src="./dzslides/core/dzslides.js"></script><script src="./dzslides/highlight/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad()</script></body></html>