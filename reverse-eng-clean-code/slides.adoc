= Reverse engineering the clean code
Jakub Marchwicki ; @kubem
:longform:
:sectids!:
:imagesdir: images
:source-highlighter: highlightjs
:language: no-highlight
:dzslides-style: stormy-jm
:dzslides-transition: fade
:dzslides-fonts: family=Yanone+Kaffeesatz:400,700,200,300&family=Cedarville+Cursive
:dzslides-highlight: monokai
:experimental:
:toc2:
:sectanchors:
:idprefix:
:idseparator: -
:icons: font

== \\
image::05-comments.png[width=500]

[NOTE]
[role="speaker"]
====
* I'd like to tell you a story how I went the path of craftmanship
** How I went beyond my daily job
* Reverse engineering the clean code
** Not in a way you turn a _class_ file into _java_ file
** In a way Mitnick reversed security through it's social aspects
* Back in 2008 I was laying down code, best I could - like most people did.
* There better and worse examples. I did was constatly improving.
** At least that's what I tought when I looked back my old code
====

== \\
image::06-comments-woohoo.png[width=573]

[NOTE]
[role="speaker"]
====
* one day I realized there can and must be a beaty in code
** prolly when I first time compared Calendar API and JodaTime
** or looked up Guava (called Google Collections at that time)
====

== \\
image::07-wtfs.jpg[role="frame"]

[NOTE]
[role="speaker"]
====
* Jest na przyklad jedna uniwersalna miara
** ale skąd wiemy że pojawiają się takie WTF.
* I dlaczego wszyscy mają takie WTFy – niezależnie od języka, doświadczenia.
* I think I can always smell the crappy code.
====

[.topic]
== Complex vs complicated

[.incremental]
Simple to read, learn and understand::
How easy it’s for novice programmer to maintain a significant program

Make stuff simple but not simplistic::

[NOTE]
[role="speaker"]
====
* complex vs complicated – w kontekście języków programowania.
* verbosity Javy vs. Groovy, frameworkach: nie pisz nowego – jednen już jest.
** ESB wygląda prosto na diagramach.
* Mythical man-month. Inherent and accidental complexity
====

== \\
image::08-books.png[caption="TODO::: Single source of truth", role="frame"]

[NOTE]
[role="speaker"]
====
* Trafiłem na kilka książek. Kto nie zna?
* Bo jak nie zna – to reszta prezentacji może być trudna do przełknięcie ;-)
====

== \\
image::10-uncle-bob.jpg[caption="Have you met Uncle Bob?", role="frame"]

[NOTE]
[role="speaker"]
====
* Now when I think about it, it was definatelly master - apprentice relation
* The rules. *The dogmna*. Variables. Names. Comments
* I realized my craft was improving
** I felt like I had this rules tatoos at my arm
* But yet another realization came
** Do I do this to keep the code maintanable, easier to change
** I kept focus beter
* My team mates are more eager to change my code
* I realized clean code wasn't on it's own. It was a result. *Not the cause*
====

[.topic]
== Uncle Bob's Basics

* Name variables in such and such way

[.source]
== \\

[source, java]
----
public static String parse_pliterki(String old_s) {
  StringBuffer old_sb = new StringBuffer(old_s);
  String new_s = "";
  for(int i=0;i<old_sb.length();i++) {
    if((int)old_sb.charAt(i)==260)
      old_sb.replace(i,i+1,"&#260;");
    if((int)old_sb.charAt(i)==261)
      old_sb.replace(i,i+1,"&#261;");
    //...
  }
  new_s += old_sb.toString();
  return new_s;
}
----

[.topic]
== Uncle Bob's Basics

* Name variables in such and such way
* Use comments when suitable and valuable

[.source]
== \\

[source, java]
----
/*
 * This class represents Customer
 */
public class Customer {

  /*
   * The customer's name
   */
  private String name;

  //....
}
----

[.topic]
== Uncle Bob's Basics

* Name variables in such and such way
* Use comments when suitable and valuable
* Split functions, decompose

[.source]
== \\

[source, csharp]
----
class Student
{
    private string name;
    private int knowledge;
    private Func<Course, bool> preferences;
    private int experience;

    public void Study()
    {
        knowledge++;
    }

    public void Enlist(IEnumerable<Course> courses)
    {
        // Select appropriate courses and enlist
        foreach (var course in courses.Where(preferences))
            course.Enlist(name);
    }

    public void Work()
    {
        experience++;
    }
}
----

[.topic]
== Uncle Bob's Basics

* Name variables in such and such way
* Use comments when suitable and valuable
* Split functions, decompose
* Use abstractions, symmetry, law of Demeter

[.source]
== \\

[source, java]
----
TextView v = (TextView)
 ((RelativeLayout)
  ((AbsoluteLayout)
   ((LinearLayout)
    ((RelativeLayout)(
    (LinearLayout)activty.findViewById(R.id.container)).getChildAt(1))
    .getChildAt(0))
   .getChildAt(element))
  .getChildAt(0))
 .getChildAt(0);
----

[.topic]
== Uncle Bob's Basics

* Name variables in such and such way
* Use comments when suitable and valuable
* Split functions, decompose
* Use abstractions, symmetry, law of Demeter
* Test, test, test. Red - green - …

[.source]
== \\

[source, java]
----
@Test
public class ExampleTest {
  public void testExample() {
    assertTrue(true);
  }
}
----

== \\
image::15-like-a-boss.jpg[caption="The SOLID programmer", role="frame"]

[NOTE]
[role="speaker"]
====
* Now I know where it's comming all from
* You can feel like a boss. Sometimes being a bit superior and dicky
* That might be how you feel when you get all that
** Or you can dig harder and deeper
** Look for some other inspirations. Go beyond beauty in code, cause it's not about beauty
* SOLID definition
* Ale to wszystko zbyt wcześnie
====

== \\
image::11-kent-beck.jpg[caption="The Sourcerer", role="frame"]

[NOTE]
[role="speaker"]
====
* That way I got to Kent Beck
* The clean code was the effect. The cause was somewhere else
** I know Uncle Bob was ranting about implementation patterns in clean code book. *I don't care*
* Kent has given this different perspective on what was important
** what the implementation was really about
====

[.topic]
== Values

[.incremental]
* Code is the communication's foundation
* We are one team, team as a whole
** My shortcuts are not smb's else problem
** Whole team's problem
* Code is read more often then written
* Spend more time maintaining than creating

[.topic]
== Implementation patterns

[.incremental]
Communication::
Read code like a prose

Simplicity::
Be aware of complexity and add when essential

Local consequences::
Data and behaviour together

[.topic]
== Implementation patterns

[.incremental]
DRY::
minimize repetition

Symmetry::
Keep the same level of abstraction

== \\

[.small.quote, Grady Booch, Object-Oriented Analysis and Design with Applications]
____
Clean code is simple and direct. Clean code reads like well-written prose. Clean code never obscures the designers’ intent but rather is full of crisp abstractions and straightforward lines of control.
____

== \\
image::12-loctus.jpg[caption="The Borg", role="frame"]

[NOTE]
[role="speaker"]
====
* Still we ask ourselves a question why are we doing that?
====

== \\
image::19-on.jpg[caption="prettiness", role="frame"]

== \\
image::19-krzeslo.jpg[caption="aesthetics", role="frame"]

== \\
image::19-syrena.jpg[caption="design", role="frame"]

[NOTE]
[role="speaker"]
====
* Each of these make you feel different emotions
** Though all wakes a sense of beauty in you. Because all of those where neatly designed.
* It's all about what we feel,what happends within our mind when we see such objectes
* Same can happen when working with beautiful code
** I'll get there
====

== \\

[quote, Trisha Gee (@trisha_gee), #JFokus (4   February 2014)]
____
For library designers, +
the API *is* the UI.
____

[NOTE]
[role="speaker"]
====
* Trisha projektowała API do MongoDB, ja Javy - ale nie tylko
* A thesis that API is pretty much like UI - similar principles, similar behvious
* Similar disorientation.
====

[.topic]
== Good design communicate

[.incremental]
* effectively
* efficiently
* easy to digest
* comfortable to read

[NOTE]
[role="speaker"]
====
* Let's get to the basis of design, some principles
** Design 101 - for those doing phisical design
** not only web pages
* seem pretty straightforward
* now eat this!
====

[.source]
== \\

[source, java]
----
Generator.prototype.update = function () {
	var	t = this.timer++,
		d = this.delay,
		s = this.samples,
		m = this.minDistance,
		w = this.width,
		h = this.height,
		g = this.global,
		c = this.cid,
		ttl = this.ttl--,
		l = s.length,
		rand = Math.random,
		floor = Math.floor,
		x, y, r, i, j, d2, n;

	if (ttl > 0) {
		while (t > d) {
			r = s[floor(rand() * l)].copy();

			if (m) {
				i = 1000;
				while (i--) {
					x = rand() * w - w * 0.5;
					y = rand() * h - h * 0.5;

					for (j in this) if (j instanceof Entity) {
						n = this[i];
						d2 = (x - n.x) * (x - n.x) + (y - n.y) * (y - n.y);

						if (d2 * d2 > m) {
							i = 0;
						}
					}
				}
			} else {
				x = rand() * w - w * 0.5;
				y = rand() * h - h * 0.5;
			}

			r.x = x;
			r.y = y;

			if (!g) {
				r.parent = this;
			}

			this[c] = r;
			this.cid = c += 1;
			this.time = t -= d;
		}
	} else {
		delete this.update;
	}
};
----

== \\

[.incremental]
Contrast:: grabs attention, relative importance
Repetition::
attach meaning to the new element
Alignment::
Keeping same things together
Proximity::
not very far away from each other

[NOTE]
[role="speaker"]
====
* This is really for graphic design, aligning of visual elements
* Kent Beck when talking about implementation patterns he was dscribing it
** He tackled each and every line of code with lot of
====

[.topic]
== TODO: slide with visual elements

[.topic]
== That was CRAP

[.statement]
*CRAP* design

[NOTE]
[role="speaker"]
====
* However it's not about remembering some juicy buzzwords
* It's not that somebody created a mem and now we design like this
* The mem was coming from somewhere, from some studies and researches
====

== \\
image::20-pudelko.jpg[caption="", role="stretch-x"]

[NOTE]
[role="speaker"]
====
* Sometimes research is about a box
* We see a box and we build a mental model around that, in our mind.
* Take this box
** We can lift it, shake it, open, look inside, put something inside
====


[.topic]
== Affordance

====
[.small.quote]
____
a *quality* of an *object*, which *allows* an individual *to perform an action*. For example, a knob affords twisting, and perhaps pushing, while a cord affords pulling
____
====

== \\
image::21-affordance.jpg[caption="affordance for dummies", role="frame"]

[NOTE]
[role="speaker"]
====
* This plate,this knob suggest an action
** These suggestions are called signifiers
====

== \\
image::21-design-of-everyday-things.jpg[caption="", role="stretch-x"]

[NOTE]
[role="speaker"]
====
* These terms were coined by Don Norman
** In this book "the design of everyday things"
* So now, think not only about phisical objects.

====

== \\
image::22-drzwi-jedi.png[caption="Only for Jedi", role="frame"]

[NOTE]
[role="speaker"]
====
* How it works - we see it on daily basis
====

== \\
image::24-android1.png[width=300]

[NOTE]
[role="speaker"]
====
* Not only among phisical objects, also in IT
** See Android. It's after all fairly easy to bash about
* See this box. It has slider, which suggests an action.
** But at the same time it's a button. WTF??
====

== \\
image::24-android1.png[width=300]
image::24-android2.png[width=287, role="pull-right"]

[NOTE]
[role="speaker"]
====
* Yeah. That was funny, but how it works with code?
** Has it's nature this sugegsts us certain actions we can or should perform.
====


== \\
image::13-functions2.png[caption="Why? Oh Why?", role="frame"]

[.source]
== \\

[source, java]
.+BadBadSql.java+
----
public class Sql {

   public Sql(String table, Column[] columns)
   public String create()
   public String insert(Object[] fields)
   public String selectAll()
   public String fieldByKey(
	String keyColumn, String keyValue)
   private String ColumnList(Column[] columns)
   private String valuesList(
	Object[] fields, final Column[] columns)

}
----

[NOTE]
[role="speaker"]
====
* So what's wrong here? Many
** Many responsibilities, too many
** Open Closed principle
** All our changes are pretty invasive
====

[.source]
== \\

[source, java]
----
abstract public class Sql {
   public Sql(String table, Column[] columns)
   abstract public String generate();
}

public class CreateSql extends Sql {
   public CreateSql(String table, Column[] columns)
   @Override public String generate()
}

public class SelectSql extends Sql {
   public SelectSql(String table, Column[] columns)
   @Override public String generate()
}

public class InsertSql extends Sql {
   public InsertSql(String table, Column[] columns)
   @Override public String generate()
   private String valuesList(Object[] fields, final Column[] columns)
}

public class FindKeyBySql extends Sql {
   public FindKeyBySql(String table, Column[] columns, String keyColumn, String keyValue)
   @Override public String generate()
}
----

[NOTE]
[role="speaker"]
====
Now take this example

* mental model: what model you build when you see this code
* affordance: what actions does this code allow you to do
* signifiers: or more, what it suggests
====

[.topic]
== Beyond design 101

[.statement]
We can *help* ourselves +
and be more *effective*

[NOTE]
[role="speaker"]
====
There is more

* George Miler. The Magical Number Seven, Plus or Minus Two: Some Limits on Our Capacity for Processing Information
* multistore memory model
** different level of memory, time to learn
* The Flow - when we find ourself within a highly challanging, engaging state of full immersion.
====

== \\
image::25-bruce-lee.png[caption="", role="frame"]


[NOTE]
[role="speaker"]
====
* So when next time you find yourself with a bit a free time, about to watch "Breaking bad"
* There is one thing I'd like you to remember
** Take away with you
====

== \\
image::25-bruce-lee.png[caption="Has Bruce Lee known kung-fu?", role="frame"]

[NOTE]
[role="speaker"]
====
* Coding is only a part of you job
* Lots of things are beyond coding
** Communication, aesthetics, desgn, psychology
* Be like Bruce Lee, who started with Kung Fu and ended with Karate
** Actually this term is coined by a friend of mine
** Michał Bartyzel, who was talking yesterday about communication and conversation patterns
* Go for Eames - The architect or Normand Design of everyday things
====


[.topic.ending, hrole="name"]
== http://goo.gl/gXwoVQ

[.pull-right]
Thank you!

[.footer]
[icon-twitter]'{zwsp}' @kubem
